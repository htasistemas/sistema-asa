{"ast":null,"code":"import { NgIf } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { AppDialogComponent } from '../shared/app-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/auth.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nfunction LoginPageComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"label\", 26);\n    i0.ɵɵtext(2, \"Confirmar senha\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 27);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginPageComponent_div_18_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.confirmarSenha = $event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.confirmarSenha);\n  }\n}\nfunction LoginPageComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.error);\n  }\n}\nfunction LoginPageComponent_app_dialog_37_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-dialog\", 29);\n    i0.ɵɵlistener(\"confirmar\", function LoginPageComponent_app_dialog_37_Template_app_dialog_confirmar_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.enviarRecuperacao());\n    })(\"cancelar\", function LoginPageComponent_app_dialog_37_Template_app_dialog_cancelar_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.fecharEsqueciSenha());\n    });\n    i0.ɵɵelementStart(1, \"div\", 30)(2, \"label\", 31);\n    i0.ɵɵtext(3, \"E-mail\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 32);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginPageComponent_app_dialog_37_Template_input_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.emailRecuperacao = $event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"mensagem\", \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.emailRecuperacao);\n  }\n}\nexport let LoginPageComponent = /*#__PURE__*/(() => {\n  var _LoginPageComponent;\n  class LoginPageComponent {\n    constructor(auth, router) {\n      this.auth = auth;\n      this.router = router;\n      this.email = '';\n      this.password = '';\n      this.confirmarSenha = '';\n      this.modoCadastro = false;\n      this.dialogoEsqueciSenhaAberto = false;\n      this.emailRecuperacao = '';\n      this.error = '';\n      this.carregando = false;\n    }\n    handleLogin() {\n      this.error = '';\n      if (!this.email || !this.password) {\n        this.error = 'Informe e-mail e senha.';\n        return;\n      }\n      this.carregando = true;\n      this.auth.login(this.email, this.password).subscribe({\n        next: () => {\n          this.carregando = false;\n          this.router.navigate(['/dashboard']);\n        },\n        error: erro => {\n          this.carregando = false;\n          if (erro.status === 403) {\n            var _erro$error;\n            const mensagemBackend = typeof erro.error === 'object' ? (_erro$error = erro.error) === null || _erro$error === void 0 ? void 0 : _erro$error.message : '';\n            this.error = (mensagemBackend === null || mensagemBackend === void 0 ? void 0 : mensagemBackend.trim()) || 'Usuario nao autorizado. Aguarde a aprovacao do administrador.';\n            return;\n          }\n          if (erro.status === 401) {\n            this.error = 'Credenciais invalidas.';\n            return;\n          }\n          this.error = 'Credenciais invalidas.';\n        }\n      });\n    }\n    handleCadastro() {\n      this.error = '';\n      if (!this.email || !this.password || !this.confirmarSenha) {\n        this.error = 'Informe e-mail, senha e confirmacao.';\n        return;\n      }\n      if (this.password !== this.confirmarSenha) {\n        this.error = 'As senhas nao conferem.';\n        return;\n      }\n      this.carregando = true;\n      this.auth.register(this.email, this.password).subscribe({\n        next: () => {\n          this.carregando = false;\n          this.modoCadastro = false;\n          this.password = '';\n          this.confirmarSenha = '';\n        },\n        error: () => {\n          this.carregando = false;\n          this.error = 'Nao foi possivel cadastrar o usuario.';\n        }\n      });\n    }\n    alternarModoCadastro() {\n      this.modoCadastro = !this.modoCadastro;\n      this.error = '';\n      this.password = '';\n      this.confirmarSenha = '';\n    }\n    abrirEsqueciSenha() {\n      this.dialogoEsqueciSenhaAberto = true;\n    }\n    fecharEsqueciSenha() {\n      this.dialogoEsqueciSenhaAberto = false;\n      this.emailRecuperacao = '';\n    }\n    enviarRecuperacao() {\n      this.error = '';\n      if (!this.emailRecuperacao.trim()) {\n        this.error = 'Informe o e-mail para recuperacao.';\n        return;\n      }\n      this.carregando = true;\n      this.auth.esqueciSenha(this.emailRecuperacao).subscribe({\n        next: () => {\n          this.carregando = false;\n          this.dialogoEsqueciSenhaAberto = false;\n          this.emailRecuperacao = '';\n          this.error = 'E-mail de recuperacao enviado com sucesso.';\n        },\n        error: erro => {\n          var _erro$error2, _erro$error3;\n          this.carregando = false;\n          if (erro.status === 404) {\n            this.error = 'E-mail nao encontrado.';\n            return;\n          }\n          const mensagemBackend = typeof erro.error === 'object' ? ((_erro$error2 = erro.error) === null || _erro$error2 === void 0 ? void 0 : _erro$error2.message) || ((_erro$error3 = erro.error) === null || _erro$error3 === void 0 ? void 0 : _erro$error3.mensagem) : erro.error;\n          this.error = (mensagemBackend || '').toString().trim() || 'Nao foi possivel enviar o e-mail de recuperacao.';\n        }\n      });\n    }\n  }\n  _LoginPageComponent = LoginPageComponent;\n  _LoginPageComponent.ɵfac = function LoginPageComponent_Factory(t) {\n    return new (t || _LoginPageComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.Router));\n  };\n  _LoginPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _LoginPageComponent,\n    selectors: [[\"app-login-page\"]],\n    standalone: true,\n    features: [i0.ɵɵStandaloneFeature],\n    decls: 38,\n    vars: 8,\n    consts: [[1, \"paginaLogin\"], [1, \"cardLogin\"], [\"aria-label\", \"Acesso restrito\", 1, \"colunaFormulario\"], [1, \"conteudoFormulario\"], [\"src\", \"assets/logo.jpg\", \"alt\", \"Logo da ASA\", 1, \"logoAsa\"], [1, \"tituloFormulario\"], [1, \"subtituloFormulario\"], [1, \"formularioLogin\", 3, \"ngSubmit\"], [1, \"grupoCampo\"], [\"for\", \"email\", 1, \"rotuloCampo\"], [\"id\", \"email\", \"name\", \"email\", \"type\", \"email\", \"placeholder\", \"Digite seu e-mail\", \"required\", \"\", 1, \"campoTexto\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"senha\", 1, \"rotuloCampo\"], [\"id\", \"senha\", \"name\", \"senha\", \"type\", \"password\", \"placeholder\", \"Digite sua senha\", \"required\", \"\", 1, \"campoTexto\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"grupoCampo\", 4, \"ngIf\"], [\"class\", \"mensagemErro\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"botaoPrimario\", 3, \"disabled\"], [1, \"acoesLogin\"], [\"type\", \"button\", 1, \"botaoSecundario\", 3, \"click\"], [\"type\", \"button\", 1, \"linkEsqueciSenha\", 3, \"click\"], [\"aria-label\", \"Mensagem institucional\", 1, \"colunaImagem\"], [1, \"sobreposicaoImagem\"], [1, \"textoImagem\"], [1, \"tituloImagem\"], [1, \"subtituloImagem\"], [1, \"rodape\"], [\"titulo\", \"Esqueci minha senha\", \"confirmarTexto\", \"Enviar\", \"cancelarTexto\", \"Cancelar\", 3, \"mensagem\", \"confirmar\", \"cancelar\", 4, \"ngIf\"], [\"for\", \"confirmarSenha\", 1, \"rotuloCampo\"], [\"id\", \"confirmarSenha\", \"name\", \"confirmarSenha\", \"type\", \"password\", \"placeholder\", \"Confirme sua senha\", \"required\", \"\", 1, \"campoTexto\", 3, \"ngModel\", \"ngModelChange\"], [1, \"mensagemErro\"], [\"titulo\", \"Esqueci minha senha\", \"confirmarTexto\", \"Enviar\", \"cancelarTexto\", \"Cancelar\", 3, \"mensagem\", \"confirmar\", \"cancelar\"], [1, \"conteudoRecuperacao\"], [\"for\", \"emailRecuperacao\", 1, \"rotuloCampo\"], [\"id\", \"emailRecuperacao\", \"name\", \"emailRecuperacao\", \"type\", \"email\", \"placeholder\", \"Digite seu e-mail\", 1, \"campoTexto\", 3, \"ngModel\", \"ngModelChange\"]],\n    template: function LoginPageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"main\", 0)(1, \"div\", 1)(2, \"section\", 2)(3, \"div\", 3);\n        i0.ɵɵelement(4, \"img\", 4);\n        i0.ɵɵelementStart(5, \"h2\", 5);\n        i0.ɵɵtext(6, \"Acesso Restrito\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"p\", 6);\n        i0.ɵɵtext(8, \"Faca login para continuar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"form\", 7);\n        i0.ɵɵlistener(\"ngSubmit\", function LoginPageComponent_Template_form_ngSubmit_9_listener() {\n          return ctx.modoCadastro ? ctx.handleCadastro() : ctx.handleLogin();\n        });\n        i0.ɵɵelementStart(10, \"div\", 8)(11, \"label\", 9);\n        i0.ɵɵtext(12, \"E-mail\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"input\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function LoginPageComponent_Template_input_ngModelChange_13_listener($event) {\n          return ctx.email = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"div\", 8)(15, \"label\", 11);\n        i0.ɵɵtext(16, \"Senha\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"input\", 12);\n        i0.ɵɵlistener(\"ngModelChange\", function LoginPageComponent_Template_input_ngModelChange_17_listener($event) {\n          return ctx.password = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(18, LoginPageComponent_div_18_Template, 4, 1, \"div\", 13);\n        i0.ɵɵtemplate(19, LoginPageComponent_div_19_Template, 2, 1, \"div\", 14);\n        i0.ɵɵelementStart(20, \"button\", 15);\n        i0.ɵɵtext(21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 16)(23, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function LoginPageComponent_Template_button_click_23_listener() {\n          return ctx.alternarModoCadastro();\n        });\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"button\", 18);\n        i0.ɵɵlistener(\"click\", function LoginPageComponent_Template_button_click_25_listener() {\n          return ctx.abrirEsqueciSenha();\n        });\n        i0.ɵɵtext(26, \"Esqueci minha senha\");\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(27, \"section\", 19);\n        i0.ɵɵelement(28, \"div\", 20);\n        i0.ɵɵelementStart(29, \"div\", 21)(30, \"h1\", 22);\n        i0.ɵɵtext(31, \"Unidos para Servir\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"p\", 23);\n        i0.ɵɵtext(33, \"Gestao solidaria e eficiente.\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(34, \"footer\", 24)(35, \"span\");\n        i0.ɵɵtext(36, \"\\u00A9 2024 Sistema de Gestao ASA\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(37, LoginPageComponent_app_dialog_37_Template, 5, 2, \"app-dialog\", 25);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngModel\", ctx.email);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.password);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.modoCadastro);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.error);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"disabled\", !ctx.email || !ctx.password || ctx.modoCadastro && !ctx.confirmarSenha || ctx.carregando);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.modoCadastro ? \"Cadastrar usuario\" : \"Entrar no Sistema\", \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\" \", ctx.modoCadastro ? \"Voltar para login\" : \"Cadastrar e-mail\", \" \");\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngIf\", ctx.dialogoEsqueciSenhaAberto);\n      }\n    },\n    dependencies: [NgIf, FormsModule, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm, AppDialogComponent],\n    styles: [\"[_nghost-%COMP%]{display:block;min-height:100vh;background-color:#f4f5f6;color:#1b1f1b;font-family:Trebuchet MS,Lucida Sans Unicode,Lucida Grande,sans-serif}.paginaLogin[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column;padding:32px 24px;gap:24px}.cardLogin[_ngcontent-%COMP%]{width:100%;max-width:1080px;background-color:#fff;border-radius:24px;box-shadow:0 22px 50px #0000001f;display:grid;grid-template-columns:1fr 1fr;overflow:hidden}.colunaFormulario[_ngcontent-%COMP%]{background-color:#fff;display:flex;flex-direction:column;justify-content:center;padding:56px 64px}.conteudoFormulario[_ngcontent-%COMP%]{width:100%;max-width:460px;margin:auto;text-align:center}.logoAsa[_ngcontent-%COMP%]{width:120px;height:120px;object-fit:contain;margin-bottom:20px;display:block;margin-left:auto;margin-right:auto}.tituloFormulario[_ngcontent-%COMP%]{margin:0 0 6px;font-size:24px;font-weight:700;color:#1f2a1f}.subtituloFormulario[_ngcontent-%COMP%]{margin:0 0 28px;color:#5f6b5f;font-size:14px}.formularioLogin[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:18px}.grupoCampo[_ngcontent-%COMP%]{text-align:left}.rotuloCampo[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-size:14px;color:#2e3a2e}.campoTexto[_ngcontent-%COMP%]{width:100%;padding:12px 14px;border-radius:10px;border:1px solid #d3d8d3;font-size:15px;outline:none;transition:border-color .2s ease,box-shadow .2s ease}.campoTexto[_ngcontent-%COMP%]:focus{border-color:#2f7a45;box-shadow:0 0 0 3px #2f7a4526}.mensagemErro[_ngcontent-%COMP%]{color:#b91c1c;font-size:13px}.botaoPrimario[_ngcontent-%COMP%]{margin-top:6px;padding:12px 16px;border:none;border-radius:12px;background-color:#2f7a45;color:#fff;font-size:15px;font-weight:700;cursor:pointer;transition:background-color .2s ease,transform .1s ease}.botaoPrimario[_ngcontent-%COMP%]:hover{background-color:#2a6e3f}.botaoPrimario[_ngcontent-%COMP%]:active{transform:translateY(1px)}.botaoPrimario[_ngcontent-%COMP%]:disabled{background-color:#a8b5aa;cursor:not-allowed}.acoesLogin[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:4px}.botaoSecundario[_ngcontent-%COMP%]{border:1px solid #d3d8d3;background-color:#fff;color:#2e3a2e;border-radius:10px;padding:8px 12px;font-size:13px;font-weight:700;cursor:pointer}.linkEsqueciSenha[_ngcontent-%COMP%]{border:none;background:transparent;color:#2f7a45;font-size:13px;font-weight:700;cursor:pointer;padding:0}.conteudoRecuperacao[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;margin-top:12px}.rodape[_ngcontent-%COMP%]{text-align:center;color:#7b857b;font-size:12px}.colunaImagem[_ngcontent-%COMP%]{position:relative;background-image:url(/assets/equipeasa.jpg);background-size:cover;background-position:center;min-height:100%}.sobreposicaoImagem[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;background:linear-gradient(180deg,rgba(0,0,0,.08) 0%,rgba(0,0,0,.25) 100%)}.textoImagem[_ngcontent-%COMP%]{position:absolute;left:28px;bottom:28px;color:#fff;z-index:1;max-width:320px}.tituloImagem[_ngcontent-%COMP%]{margin:0 0 8px;font-size:28px;font-weight:700;letter-spacing:.4px}.subtituloImagem[_ngcontent-%COMP%]{margin:0;font-size:14px;opacity:.9}@media (max-width: 900px){.cardLogin[_ngcontent-%COMP%]{grid-template-columns:1fr}.colunaFormulario[_ngcontent-%COMP%]{padding:36px 24px}.conteudoFormulario[_ngcontent-%COMP%]{max-width:100%}.colunaImagem[_ngcontent-%COMP%]{min-height:240px}}\"]\n  });\n  return LoginPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}