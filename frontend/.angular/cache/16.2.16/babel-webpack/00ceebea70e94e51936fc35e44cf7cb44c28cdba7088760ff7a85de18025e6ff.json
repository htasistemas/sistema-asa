{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/backup.service\";\nimport * as i2 from \"@angular/common\";\nfunction BackupPageComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"mensagemSucesso\", ctx_r0.tipoMensagem === \"sucesso\")(\"mensagemErro\", ctx_r0.tipoMensagem === \"erro\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.mensagem, \" \");\n  }\n}\nexport let BackupPageComponent = /*#__PURE__*/(() => {\n  var _BackupPageComponent;\n  class BackupPageComponent {\n    constructor(backupService) {\n      this.backupService = backupService;\n      this.carregandoBackup = false;\n      this.carregandoRestauracao = false;\n      this.mensagem = '';\n      this.tipoMensagem = '';\n      this.arquivoSelecionado = null;\n    }\n    selecionarArquivo(evento) {\n      var _input$files;\n      const input = evento.target;\n      const arquivo = (input === null || input === void 0 || (_input$files = input.files) === null || _input$files === void 0 ? void 0 : _input$files[0]) || null;\n      this.arquivoSelecionado = arquivo;\n    }\n    baixarBackup() {\n      this.limparMensagem();\n      this.carregandoBackup = true;\n      this.backupService.baixarBackup().subscribe({\n        next: blob => {\n          const url = URL.createObjectURL(blob);\n          const link = document.createElement('a');\n          link.href = url;\n          link.download = `backup-asa-${this.gerarData()}.sql`;\n          link.click();\n          URL.revokeObjectURL(url);\n          this.carregandoBackup = false;\n          this.definirMensagem('Backup gerado com sucesso.', 'sucesso');\n        },\n        error: () => {\n          this.carregandoBackup = false;\n          this.definirMensagem('Nao foi possivel gerar o backup.', 'erro');\n        }\n      });\n    }\n    restaurarBackup() {\n      this.limparMensagem();\n      if (!this.arquivoSelecionado) {\n        this.definirMensagem('Selecione um arquivo de backup para restaurar.', 'erro');\n        return;\n      }\n      this.carregandoRestauracao = true;\n      this.backupService.restaurarBackup(this.arquivoSelecionado).subscribe({\n        next: resposta => {\n          this.carregandoRestauracao = false;\n          this.definirMensagem(resposta.mensagem || 'Backup restaurado com sucesso.', 'sucesso');\n        },\n        error: () => {\n          this.carregandoRestauracao = false;\n          this.definirMensagem('Nao foi possivel restaurar o backup.', 'erro');\n        }\n      });\n    }\n    gerarData() {\n      const agora = new Date();\n      const ano = agora.getFullYear();\n      const mes = String(agora.getMonth() + 1).padStart(2, '0');\n      const dia = String(agora.getDate()).padStart(2, '0');\n      const hora = String(agora.getHours()).padStart(2, '0');\n      const minuto = String(agora.getMinutes()).padStart(2, '0');\n      return `${ano}${mes}${dia}-${hora}${minuto}`;\n    }\n    definirMensagem(mensagem, tipo) {\n      this.mensagem = mensagem;\n      this.tipoMensagem = tipo;\n    }\n    limparMensagem() {\n      this.mensagem = '';\n      this.tipoMensagem = '';\n    }\n  }\n  _BackupPageComponent = BackupPageComponent;\n  _BackupPageComponent.ɵfac = function BackupPageComponent_Factory(t) {\n    return new (t || _BackupPageComponent)(i0.ɵɵdirectiveInject(i1.BackupService));\n  };\n  _BackupPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _BackupPageComponent,\n    selectors: [[\"app-backup-page\"]],\n    standalone: true,\n    features: [i0.ɵɵStandaloneFeature],\n    decls: 27,\n    vars: 5,\n    consts: [[1, \"paginaBackup\"], [1, \"topoPagina\"], [1, \"linhaTopo\"], [1, \"identificadorModulo\"], [1, \"tituloPagina\"], [1, \"comentarioDidatico\"], [1, \"gradeBackup\"], [1, \"cartaoBackup\"], [1, \"tituloSecao\"], [1, \"descricaoSecao\"], [\"type\", \"button\", 1, \"botaoAcao\", \"botaoPrimario\", 3, \"disabled\", \"click\"], [\"type\", \"file\", \"accept\", \".sql\", 1, \"campoArquivo\", 3, \"change\"], [\"type\", \"button\", 1, \"botaoAcao\", \"botaoPerigo\", 3, \"disabled\", \"click\"], [\"class\", \"mensagemResultado\", 3, \"mensagemSucesso\", \"mensagemErro\", 4, \"ngIf\"], [1, \"mensagemResultado\"]],\n    template: function BackupPageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\")(4, \"div\", 3);\n        i0.ɵɵtext(5, \"OPERACIONAL\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4);\n        i0.ɵɵtext(7, \"Backup e Restaura\\u00E7\\u00E3o\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"p\", 5);\n        i0.ɵɵtext(9, \"Exporta\\u00E7\\u00E3o e recupera\\u00E7\\u00E3o completa do sistema ASA.\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(10, \"div\", 6)(11, \"div\", 7)(12, \"h3\", 8);\n        i0.ɵɵtext(13, \"Backup Geral\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"p\", 9);\n        i0.ɵɵtext(15, \"Gera um arquivo com todas as tabelas do sistema para armazenamento seguro.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"button\", 10);\n        i0.ɵɵlistener(\"click\", function BackupPageComponent_Template_button_click_16_listener() {\n          return ctx.baixarBackup();\n        });\n        i0.ɵɵtext(17);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"div\", 7)(19, \"h3\", 8);\n        i0.ɵɵtext(20, \"Restaura\\u00E7\\u00E3o Geral\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"p\", 9);\n        i0.ɵɵtext(22, \"Substitui os dados atuais pelo conte\\u00FAdo do arquivo selecionado.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"input\", 11);\n        i0.ɵɵlistener(\"change\", function BackupPageComponent_Template_input_change_23_listener($event) {\n          return ctx.selecionarArquivo($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function BackupPageComponent_Template_button_click_24_listener() {\n          return ctx.restaurarBackup();\n        });\n        i0.ɵɵtext(25);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(26, BackupPageComponent_div_26_Template, 2, 5, \"div\", 13);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(16);\n        i0.ɵɵproperty(\"disabled\", ctx.carregandoBackup);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.carregandoBackup ? \"Gerando...\" : \"Baixar Backup\", \" \");\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"disabled\", ctx.carregandoRestauracao);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \", ctx.carregandoRestauracao ? \"Restaurando...\" : \"Restaurar Backup\", \" \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.mensagem);\n      }\n    },\n    dependencies: [CommonModule, i2.NgIf],\n    styles: [\".paginaBackup[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.topoPagina[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.linhaTopo[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px}.identificadorModulo[_ngcontent-%COMP%]{font-size:12px;text-transform:uppercase;letter-spacing:.08em;color:#7b857b}.tituloPagina[_ngcontent-%COMP%]{font-size:24px;font-weight:700}.comentarioDidatico[_ngcontent-%COMP%]{font-size:12px;color:#5f6b5f;text-align:right;max-width:260px}.gradeBackup[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:20px}.cartaoBackup[_ngcontent-%COMP%]{background-color:#fff;border-radius:16px;border:1px solid #e1e5e1;padding:20px;box-shadow:0 6px 16px #0000000a;display:flex;flex-direction:column;gap:12px}.tituloSecao[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:700}.descricaoSecao[_ngcontent-%COMP%]{margin:0;color:#5f6b5f;font-size:14px}.campoArquivo[_ngcontent-%COMP%]{border:1px solid #d8ddd8;border-radius:10px;padding:10px;background:#ffffff}.botaoAcao[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:1px solid #d8ddd8;background-color:#fff;color:#2e3a2e;border-radius:8px;padding:10px 14px;font-weight:600;font-size:13px;cursor:pointer}.botaoPrimario[_ngcontent-%COMP%]{background-color:#2f7a45;color:#fff;border-color:#2f7a45}.botaoPerigo[_ngcontent-%COMP%]{background-color:#dc2626;color:#fff;border-color:#dc2626}.mensagemResultado[_ngcontent-%COMP%]{padding:10px 14px;border-radius:8px;font-weight:600;font-size:13px}.mensagemSucesso[_ngcontent-%COMP%]{background-color:#e7f6ed;color:#166534}.mensagemErro[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}@media (max-width: 900px){.linhaTopo[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.comentarioDidatico[_ngcontent-%COMP%]{text-align:left;max-width:none}}\"]\n  });\n  return BackupPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}